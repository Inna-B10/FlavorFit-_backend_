model Recipe {
  recipeId    String @id @default(cuid()) @map("recipe_id")
  title       String
  description String

  calories    Int?
  cookingTime Int?       @map("cooking_time")
  difficulty  Difficulty

  author   User   @relation(fields: [authorId], references: [userId])
  authorId String @map("author_id")

  ingredients RecipeIngredient[]
  recipeSteps RecipeStep[]

  comments Comment[]
  likes    Like[]

  shoppingListRecipes     ShoppingListRecipe[]
  shoppingListItemSources ShoppingListItemSource[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("recipes")
}

model RecipeIngredient {
  recipeIngredientId String  @id @default(cuid()) @map("recipe_ingredient_id")
  quantity           Decimal @db.Decimal(10, 3)
  unit               Unit

  recipe   Recipe @relation(fields: [recipeId], references: [recipeId], onDelete: Cascade)
  recipeId String @map("recipe_id")

  product   Product @relation(fields: [productId], references: [productId])
  productId String  @map("product_id")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@unique([recipeId, productId]) // one ingredient - once in the recipe
  @@map("recipe_ingredients")
}

model RecipeStep {
  recipeStepId String @id @default(cuid()) @map("recipe_steps_id")
  order        Int
  title        String
  description  String

  recipe   Recipe @relation(fields: [recipeId], references: [recipeId], onDelete: Cascade)
  recipeId String @map("recipe_id")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("recipe_steps")
}
